{"version":3,"file":"OpenTelemetryTransportV3.js","sourceRoot":"","sources":["../../src/OpenTelemetryTransportV3.ts"],"names":[],"mappings":";AAAA;;;;;;;;;;;;;;GAcG;;;AAEH,sDAAuD;AACvD,+CAA+C;AAC/C,uCAAoC;AACpC,mCAAwC;AAExC,MAAa,wBAAyB,SAAQ,SAAS;IAGrD,YAAY,OAA0C;QACpD,KAAK,CAAC,OAAO,CAAC,CAAC;QACf,IAAI,CAAC,OAAO,GAAG,eAAI,CAAC,SAAS,CAAC,kCAAkC,EAAE,iBAAO,CAAC,CAAC;IAC7E,CAAC;IAEe,GAAG,CAAC,IAAS,EAAE,IAAgB;QAC7C,IAAI;YACF,IAAA,qBAAa,EAAC,IAAI,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;SACnC;QAAC,OAAO,KAAK,EAAE;YACd,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;SAC1B;QACD,YAAY,CAAC,GAAG,EAAE;YAChB,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;QAC5B,CAAC,CAAC,CAAC;QACH,IAAI,IAAI,EAAE;YACR,YAAY,CAAC,IAAI,CAAC,CAAC;SACpB;IACH,CAAC;CACF;AArBD,4DAqBC","sourcesContent":["/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Logger, logs } from '@opentelemetry/api-logs';\nimport * as Transport from 'winston-transport';\nimport { VERSION } from './version';\nimport { emitLogRecord } from './utils';\n\nexport class OpenTelemetryTransportV3 extends Transport {\n  private _logger: Logger;\n\n  constructor(options?: Transport.TransportStreamOptions) {\n    super(options);\n    this._logger = logs.getLogger('@opentelemetry/winston-transport', VERSION);\n  }\n\n  public override log(info: any, next: () => void) {\n    try {\n      emitLogRecord(info, this._logger);\n    } catch (error) {\n      this.emit('warn', error);\n    }\n    setImmediate(() => {\n      this.emit('logged', info);\n    });\n    if (next) {\n      setImmediate(next);\n    }\n  }\n}\n"]}